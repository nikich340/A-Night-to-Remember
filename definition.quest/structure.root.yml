#
# quest structure root segment
# 
# (version: 510, saved: 2020-07-14 23:15:54)
#
---
structure:
  quest:
    blocks:
      start:
        ".editor": [ -407.4636230469, 482.2406005859 ]
        next:
          - waituntil.wait_quest_allowed
          - changelayers.hide_hide_hide
      
      subsegment.camp:
        ".editor":
          pos: [ 1196.6180419922, 486.6039428711 ]
          in: [ In ]
          out: [ Out ]
        segment: camp
        next:
          - changelayers.show_town_blood
          - script.check_camp_removed3
      
      subsegment.intro_nightmare:
        ".editor":
          pos: [ 237.6061553955, 504.0928955078 ]
          in: [ In ]
          out: [ Out ]
        segment: intro_nightmare
        next:
          - subsegment.regis_mail
      
      subsegment.orphanage:
        ".editor":
          pos: [ 790.9936523438, 491.5223693848 ]
          in: [ In ]
          out: [ Out ]
        segment: orphanage
        next:
          - subsegment.camp
      
      subsegment.regis_mail:
        ".editor":
          pos: [ 452.4227905273, 503.7007141113 ]
          in: [ In ]
          out: [ Out ]
        segment: regis_mail
        next:
          - changelayers.show_orphlayer
      
      subsegment.town_part:
        ".editor":
          pos: [ 1518.2768554688, 444.2366943359 ]
          in: [ In ]
          out: [ Out ]
        segment: town_part
        next:
          - end
      
      interaction.baron_not_yet_gp:
        ".editor":
          pos: [ 1335.203125, 257.7951049805 ]
          in: [ camp_not_yet ]
          out: [ Output ]
        scene: 17.baron_oneliners.yml
        placement: bob/camp
        interruptable: true
        actor: [ ntr_baron_edward ]
        next.Output:
          - script.check_camp_removed3
      
      waituntil.midnight:
        time: [ "00:00", "01:00" ]
        ".editor":
          pos: [ 654.8952026367, 1004.3184814453 ]
          in: [ In ]
          out: [ Out ]
        next:
          - script.check_camp_removed2
      
      waituntil.night_time:
        time: [ "00:00", "04:00" ]
        ".editor":
          pos: [ 491.9230041504, -245.4349060059 ]
          in: [ In ]
          out: [ Out ]
        next:
          - addfact.fact_add11
      
      waituntil.non_night_time:
        time: [ "04:01", "23:59" ]
        ".editor":
          pos: [ 622.0083618164, -81.7935943604 ]
          in: [ In ]
          out: [ Out ]
        next:
          - addfact.del_fact11
      
      waituntil.outside_area:
        outside: [ bob/orphanage_wraitharea, PLAYER ]
        ".editor":
          pos: [ 754.7053222656, 222.8629760742 ]
          in: [ In ]
          out: [ Out ]
        next:
          - addfact.del_fact1
      
      waituntil.time_brake:
        time: [ "01:01", "23:59" ]
        ".editor":
          pos: [ 754.6542358398, 918.5596923828 ]
          in: [ In ]
          out: [ Out ]
        next:
          - waituntil.midnight
      
      waituntil.wait_day:
        time: [ "08:01", "23:59" ]
        ".editor":
          pos: [ 1028.6828613281, 812.134765625 ]
          in: [ In ]
          out: [ Out ]
        next:
          - spawnsets.camp_axe_day
      
      waituntil.wait_night:
        time: [ "00:00", "08:00" ]
        ".editor":
          pos: [ 873.0985717773, 673.3035888672 ]
          in: [ In ]
          out: [ Out ]
        next:
          - script.check_camp_removed
      
      waituntil.wait_quest_allowed:
        factdb: [ NTRstartquest, ">=", 1 ]
        ".editor":
          pos: [ -200.99609375, 487.9546813965 ]
          in: [ In ]
          out: [ Out ]
        next:
          - changelayers.show_camp_river_main
      
      waituntil.wraith_area:
        inside: [ bob/orphanage_wraitharea, PLAYER ]
        ".editor":
          pos: [ 636.0413818359, 94.8574752808 ]
          in: [ In ]
          out: [ Out ]
        next:
          - addfact.fact_add1
      
      script.FACT_BRANCH:
        ".editor":
          pos: [ 983.391418457, -65.5462341309 ]
          in: [ In ]
          out: [ "False", "True" ]
        function: NTR_FactChecker
        parameter:
          - factName: NTR_orphanage_wraith
          - factCond: "=="
          - val: 2
        next.True:
          - spawn.spawn_wraiths
      
      script.FACT_BRANCH1:
        ".editor":
          pos: [ 429.0227966309, -69.3067398071 ]
          in: [ In ]
          out: [ "False", "True" ]
        function: NTR_FactChecker
        parameter:
          - factName: NTR_orphanage_wraith
          - factCond: "=="
          - val: 2
        next.False:
          - waituntil.non_night_time
      
      script.FACT_BRANCH2:
        ".editor":
          pos: [ 541.5682373047, 226.8706359863 ]
          in: [ In ]
          out: [ "False", "True" ]
        function: NTR_FactChecker
        parameter:
          - factName: NTR_orphanage_wraith
          - factCond: "=="
          - val: 2
        next.False:
          - waituntil.outside_area
      
      script.check_camp_removed:
        ".editor":
          pos: [ 1099.4495849609, 721.0264282227 ]
          in: [ In ]
          out: [ "False", "True" ]
        function: NTR_FactChecker
        parameter:
          - factName: ntr_remove_camp
          - factCond: "=="
          - val: 1
        next.False:
          - spawnsets.camp_axe_night
      
      script.check_camp_removed2:
        ".editor":
          pos: [ 863.3322143555, 1003.0321044922 ]
          in: [ In ]
          out: [ "False", "True" ]
        function: NTR_FactChecker
        parameter:
          - factName: ntr_remove_camp
          - factCond: "=="
          - val: 1
        next.False:
          - script.teleport_horse1
          - script.teleport_horse2
          - script.teleport_horse3
          - script.teleport_horse_baron
      
      script.check_camp_removed3:
        ".editor":
          pos: [ 1346.3770751953, 346.690826416 ]
          in: [ In ]
          out: [ "False", "True" ]
        function: NTR_FactChecker
        parameter:
          - factName: ntr_remove_camp
          - factCond: "=="
          - val: 1
        next.False:
          - interaction.baron_not_yet_gp: camp_not_yet
      
      script.sounds_dettlaff:
        ".editor":
          pos: [ 137.6712799072, 377.7290344238 ]
          in: [ In ]
          out: [ Out ]
        function: playSoundsCustom
        next: ".done"
      
      script.teleport_horse1:
        ".editor":
          pos: [ 1185.8624267578, 992.9293212891 ]
          in: [ In ]
          out: [ Out ]
        function: NTR_teleportToNode
        parameter:
          - tag: cname_ntr_camp_horse1
          - tagNode: cname_ntr_bob_horse1_parked_ap
          - applyRotation: true
        next:
          - waituntil.time_brake
      
      script.teleport_horse2:
        ".editor":
          pos: [ 1192.2021484375, 1072.3410644531 ]
          in: [ In ]
          out: [ Out ]
        function: NTR_teleportToNode
        parameter:
          - tag: cname_ntr_camp_horse2
          - tagNode: cname_ntr_bob_horse2_parked_ap
          - applyRotation: true
        next: ".done"
      
      script.teleport_horse3:
        ".editor":
          pos: [ 1202.3704833984, 1153.1068115234 ]
          in: [ In ]
          out: [ Out ]
        function: NTR_teleportToNode
        parameter:
          - tag: cname_ntr_camp_horse3
          - tagNode: cname_ntr_bob_horse3_parked_ap
          - applyRotation: true
        next: ".done"
      
      script.teleport_horse_baron:
        ".editor":
          pos: [ 1205.6477050781, 1231.9954833984 ]
          in: [ In ]
          out: [ Out ]
        function: NTR_teleportToNode
        parameter:
          - tag: cname_ntr_camp_horse_baron
          - tagNode: cname_ntr_bob_horse_baron_parked_ap
          - applyRotation: true
        next: ".done"
      
      changelayers.hide_hide_hide:
        ".editor":
          pos: [ -209.238067627, 576.571472168 ]
          hint: hide-only
          in: []
          out: []
        sync: true
        purge: false
        world: bob
        hide:
          - after_hag
          - after_triss_to_monster
          - owl_layer
          - orphanage_layer
          - town_blood
        next: ".done"
      
      changelayers.show_camp_river_main:
        ".editor":
          pos: [ 19.7808647156, 637.2651367188 ]
          hint: show-only
          in: []
          out: []
        sync: true
        purge: false
        world: bob
        show:
          - camp_layer
          - river
          - nlayer
        next:
          - spawn.spawn_fisherman
          - spawn.spawn_bandits_camp
          - spawn.spawn_horses
          - spawn.spawn_baron
          - changelayers.show_town_blood
      
      changelayers.show_orphlayer:
        ".editor":
          pos: [ 621.4846801758, 414.8437194824 ]
          hint: show-only
          in: []
          out: []
        sync: true
        purge: false
        world: bob
        show:
          - orphanage_layer
        next:
          - subsegment.orphanage
          - waituntil.wraith_area
          - waituntil.night_time
      
      changelayers.show_town_blood:
        ".editor":
          pos: [ 1367.0268554688, 549.1499633789 ]
          hint: show-only
          in: []
          out: []
        sync: true
        purge: false
        world: bob
        show:
          - town_blood
        next:
          - subsegment.town_part
      
      spawnsets.camp_axe_day:
        ".editor":
          pos: [ 669.5758666992, 726.4351196289 ]
          hint: both
          in: []
          out: []
        phase: usual_day
        spawn:
          - comm_camp_bandit_axe_day
        despawn:
          - comm_camp_bandit_axe_night
        next:
          - waituntil.wait_night
      
      spawnsets.camp_axe_night:
        ".editor":
          pos: [ 738.619140625, 833.8095092773 ]
          hint: both
          in: []
          out: []
        phase: patrolling_night
        spawn:
          - comm_camp_bandit_axe_night
        despawn:
          - comm_camp_bandit_axe_day
        next:
          - waituntil.wait_day
      
      spawn.spawn_bandits_camp:
        ".editor":
          pos: [ 279.1846313477, 787.2491455078 ]
          hint: spawn-only
          in: []
          out: []
        phase: camp_full
        spawnsets:
          - comm_camp_bandits
        next:
          - spawnsets.camp_axe_day
          - waituntil.midnight
      
      spawn.spawn_baron:
        ".editor":
          pos: [ 280.1955566406, 936.8741455078 ]
          hint: spawn-only
          in: []
          out: []
        phase: usual_day
        spawnsets:
          - comm_camp_baron
        next: ".done"
      
      spawn.spawn_fisherman:
        ".editor":
          pos: [ 279.3647766113, 710.0003662109 ]
          hint: spawn-only
          in: []
          out: []
        phase: usual
        spawnsets:
          - comm_fisherman
        next: ".done"
      
      spawn.spawn_horses:
        ".editor":
          pos: [ 281.1846313477, 855.7490844727 ]
          hint: spawn-only
          in: []
          out: []
        phase: camp_horses_full
        spawnsets:
          - comm_camp_horses
        next: ".done"
      
      spawn.spawn_wraiths:
        ".editor":
          pos: [ 1168.5069580078, -23.5438270569 ]
          hint: spawn-only
          in: []
          out: []
        phase: fight
        spawnsets:
          - comm_orph_wraiths
        next: ".done"
      
      addfact.del_fact1:
        ".editor": [ 952.7802734375, 217.9209899902 ]
        value: [ NTR_orphanage_wraith, -1 ]
        next:
          - waituntil.wraith_area
      
      addfact.del_fact11:
        ".editor": [ 811.9638671875, -80.3769302368 ]
        value: [ NTR_orphanage_wraith, -1 ]
        next:
          - waituntil.night_time
      
      addfact.fact_add1:
        ".editor": [ 824.43359375, 89.9456558228 ]
        value: [ NTR_orphanage_wraith, 1 ]
        next:
          - script.FACT_BRANCH2
          - script.FACT_BRANCH
      
      addfact.fact_add11:
        ".editor": [ 791.5753173828, -239.6225128174 ]
        value: [ NTR_orphanage_wraith, 1 ]
        next:
          - script.FACT_BRANCH
          - script.FACT_BRANCH1
      
      end:
        ".editor": [ 1741.3498535156, 437.2974853516 ]
        next: ".done"
      
